CKEDITOR.dom.element=function(element,ownerDocument){if(typeof element=="string")element=(ownerDocument?ownerDocument.$:document).createElement(element);CKEDITOR.dom.domObject.call(this,element)};CKEDITOR.dom.element.get=function(element){return element&&(element.$?element:new CKEDITOR.dom.element(element))};CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node;
CKEDITOR.dom.element.createFromHtml=function(html,ownerDocument){var temp=new CKEDITOR.dom.element("div",ownerDocument);temp.setHtml(html);return temp.getFirst().remove()};
CKEDITOR.dom.element.setMarker=function(database,element,name,value){var id=element.getCustomData("list_marker_id")||element.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),markerNames=element.getCustomData("list_marker_names")||element.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");database[id]=element;markerNames[name]=1;return element.setCustomData(name,value)};
CKEDITOR.dom.element.clearAllMarkers=function(database){for(var i in database)CKEDITOR.dom.element.clearMarkers(database,database[i],1)};CKEDITOR.dom.element.clearMarkers=function(database,element,removeFromDatabase){var names=element.getCustomData("list_marker_names"),id=element.getCustomData("list_marker_id");for(var i in names)element.removeCustomData(i);element.removeCustomData("list_marker_names");if(removeFromDatabase){element.removeCustomData("list_marker_id");delete database[id]}};
CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:function(className){var c=this.$.className;if(c){var regex=new RegExp("(?:^|\\s)"+className+"(?:\\s|$)","");if(!regex.test(c))c+=" "+className}this.$.className=c||className},removeClass:function(className){var c=this.getAttribute("class");if(c){var regex=new RegExp("(?:^|\\s+)"+className+"(?=\\s|$)","i");if(regex.test(c)){c=c.replace(regex,"").replace(/^\s+/,"");if(c)this.setAttribute("class",c);else this.removeAttribute("class")}}},
hasClass:function(className){var regex=new RegExp("(?:^|\\s+)"+className+"(?=\\s|$)","");return regex.test(this.getAttribute("class"))},append:function(node,toStart){if(typeof node=="string")node=this.getDocument().createElement(node);if(toStart)this.$.insertBefore(node.$,this.$.firstChild);else this.$.appendChild(node.$);return node},appendHtml:function(html){if(!this.$.childNodes.length)this.setHtml(html);else{var temp=new CKEDITOR.dom.element("div",this.getDocument());temp.setHtml(html);temp.moveChildren(this)}},
appendText:function(text){if(this.$.text!=undefined)this.$.text+=text;else this.append(new CKEDITOR.dom.text(text))},appendBogus:function(){var lastChild=this.getLast();while(lastChild&&lastChild.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(lastChild.getText()))lastChild=lastChild.getPrevious();if(!lastChild||!lastChild.is||!lastChild.is("br")){var bogus=CKEDITOR.env.opera?this.getDocument().createText(""):this.getDocument().createElement("br");CKEDITOR.env.gecko&&bogus.setAttribute("type","_moz");
this.append(bogus)}},breakParent:function(parent){var range=new CKEDITOR.dom.range(this.getDocument());range.setStartAfter(this);range.setEndAfter(parent);var docFrag=range.extractContents();range.insertNode(this.remove());docFrag.insertAfterNode(this)},contains:CKEDITOR.env.ie||CKEDITOR.env.webkit?function(node){var $=this.$;return node.type!=CKEDITOR.NODE_ELEMENT?$.contains(node.getParent().$):$!=node.$&&$.contains(node.$)}:function(node){return!!(this.$.compareDocumentPosition(node.$)&16)},focus:function(){function exec(){try{this.$.focus()}catch(e){}}
return function(defer){if(defer)CKEDITOR.tools.setTimeout(exec,100,this);else exec.call(this)}}(),getHtml:function(){var retval=this.$.innerHTML;return CKEDITOR.env.ie?retval.replace(/<\?[^>]*>/g,""):retval},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var tmpDiv=this.$.ownerDocument.createElement("div");tmpDiv.appendChild(this.$.cloneNode(true));return tmpDiv.innerHTML},setHtml:function(html){return this.$.innerHTML=html},setText:function(text){CKEDITOR.dom.element.prototype.setText=
this.$.innerText!=undefined?function(text){return this.$.innerText=text}:function(text){return this.$.textContent=text};return this.setText(text)},getAttribute:function(){var standard=function(name){return this.$.getAttribute(name,2)};if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat))return function(name){switch(name){case "class":name="className";break;case "http-equiv":name="httpEquiv";break;case "name":return this.$.name;case "tabindex":var tabIndex=standard.call(this,name);
if(tabIndex!==0&&this.$.tabIndex===0)tabIndex=null;return tabIndex;break;case "checked":var attr=this.$.attributes.getNamedItem(name),attrValue=attr.specified?attr.nodeValue:this.$.checked;return attrValue?"checked":null;case "hspace":case "value":return this.$[name];case "style":return this.$.style.cssText}return standard.call(this,name)};else return standard}(),getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:CKEDITOR.env.ie?function(propertyName){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(propertyName)]}:
function(propertyName){return this.getWindow().$.getComputedStyle(this.$,"").getPropertyValue(propertyName)},getDtd:function(){var dtd=CKEDITOR.dtd[this.getName()];this.getDtd=function(){return dtd};return dtd},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:CKEDITOR.env.ie?function(){var tabIndex=this.$.tabIndex;if(tabIndex===0&&!CKEDITOR.dtd.$tabIndex[this.getName()]&&parseInt(this.getAttribute("tabindex"),10)!==0)tabIndex=-1;return tabIndex}:CKEDITOR.env.webkit?function(){var tabIndex=
this.$.tabIndex;if(tabIndex==undefined){tabIndex=parseInt(this.getAttribute("tabindex"),10);if(isNaN(tabIndex))tabIndex=-1}return tabIndex}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var nodeName=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&!(document.documentMode>8)){var scopeName=
this.$.scopeName;if(scopeName!="HTML")nodeName=scopeName.toLowerCase()+":"+nodeName}return(this.getName=function(){return nodeName})()},getValue:function(){return this.$.value},getFirst:function(evaluator){var first=this.$.firstChild,retval=first&&new CKEDITOR.dom.node(first);if(retval&&evaluator&&!evaluator(retval))retval=retval.getNext(evaluator);return retval},getLast:function(evaluator){var last=this.$.lastChild,retval=last&&new CKEDITOR.dom.node(last);if(retval&&evaluator&&!evaluator(retval))retval=
retval.getPrevious(evaluator);return retval},getStyle:function(name){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(name)]},is:function(){var name=this.getName();for(var i=0;i<arguments.length;i++)if(arguments[i]==name)return true;return false},isEditable:function(textCursor){var name=this.getName();if(this.isReadOnly()||this.getComputedStyle("display")=="none"||this.getComputedStyle("visibility")=="hidden"||CKEDITOR.dtd.$nonEditable[name])return false;if(textCursor!==false){var dtd=CKEDITOR.dtd[name]||
CKEDITOR.dtd.span;return dtd&&dtd["#"]}return true},isIdentical:function(otherElement){if(this.getName()!=otherElement.getName())return false;var thisAttribs=this.$.attributes,otherAttribs=otherElement.$.attributes;var thisLength=thisAttribs.length,otherLength=otherAttribs.length;for(var i=0;i<thisLength;i++){var attribute=thisAttribs[i];if(attribute.nodeName=="_moz_dirty")continue;if((!CKEDITOR.env.ie||attribute.specified&&attribute.nodeName!="data-cke-expando")&&attribute.nodeValue!=otherElement.getAttribute(attribute.nodeName))return false}if(CKEDITOR.env.ie)for(i=
0;i<otherLength;i++){attribute=otherAttribs[i];if(attribute.specified&&attribute.nodeName!="data-cke-expando"&&attribute.nodeValue!=this.getAttribute(attribute.nodeName))return false}return true},isVisible:function(){var isVisible=(this.$.offsetHeight||this.$.offsetWidth)&&this.getComputedStyle("visibility")!="hidden",elementWindow,elementWindowFrame;if(isVisible&&(CKEDITOR.env.webkit||CKEDITOR.env.opera)){elementWindow=this.getWindow();if(!elementWindow.equals(CKEDITOR.document.getWindow())&&(elementWindowFrame=
elementWindow.$.frameElement))isVisible=(new CKEDITOR.dom.element(elementWindowFrame)).isVisible()}return!!isVisible},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return false;var children=this.getChildren();for(var i=0,count=children.count();i<count;i++){var child=children.getItem(i);if(child.type==CKEDITOR.NODE_ELEMENT&&child.data("cke-bookmark"))continue;if(child.type==CKEDITOR.NODE_ELEMENT&&!child.isEmptyInlineRemoveable()||child.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(child.getText()))return false}return true},
hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)?function(){var attributes=this.$.attributes;for(var i=0;i<attributes.length;i++){var attribute=attributes[i];switch(attribute.nodeName){case "class":if(this.getAttribute("class"))return true;case "data-cke-expando":continue;default:if(attribute.specified)return true}}return false}:function(){var attrs=this.$.attributes,attrsNum=attrs.length;var execludeAttrs={"data-cke-expando":1,_moz_dirty:1};return attrsNum>0&&(attrsNum>
2||!execludeAttrs[attrs[0].nodeName]||attrsNum==2&&!execludeAttrs[attrs[1].nodeName])},hasAttribute:function(){function standard(name){var $attr=this.$.attributes.getNamedItem(name);return!!($attr&&$attr.specified)}return CKEDITOR.env.ie&&CKEDITOR.env.version<8?function(name){if(name=="name")return!!this.$.name;return standard.call(this,name)}:standard}(),hide:function(){this.setStyle("display","none")},moveChildren:function(target,toStart){var $=this.$;target=target.$;if($==target)return;var child;
if(toStart)while(child=$.lastChild)target.insertBefore($.removeChild(child),target.firstChild);else while(child=$.firstChild)target.appendChild($.removeChild(child))},mergeSiblings:function(){function mergeElements(element,sibling,isNext){if(sibling&&sibling.type==CKEDITOR.NODE_ELEMENT){var pendingNodes=[];while(sibling.data("cke-bookmark")||sibling.isEmptyInlineRemoveable()){pendingNodes.push(sibling);sibling=isNext?sibling.getNext():sibling.getPrevious();if(!sibling||sibling.type!=CKEDITOR.NODE_ELEMENT)return}if(element.isIdentical(sibling)){var innerSibling=
isNext?element.getLast():element.getFirst();while(pendingNodes.length)pendingNodes.shift().move(element,!isNext);sibling.moveChildren(element,!isNext);sibling.remove();if(innerSibling&&innerSibling.type==CKEDITOR.NODE_ELEMENT)innerSibling.mergeSiblings()}}}return function(inlineOnly){if(!(inlineOnly===false||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a")))return;mergeElements(this,this.getNext(),true);mergeElements(this,this.getPrevious())}}(),show:function(){this.setStyles({display:"",visibility:""})},
setAttribute:function(){var standard=function(name,value){this.$.setAttribute(name,value);return this};if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat))return function(name,value){if(name=="class")this.$.className=value;else if(name=="style")this.$.style.cssText=value;else if(name=="tabindex")this.$.tabIndex=value;else if(name=="checked")this.$.checked=value;else standard.apply(this,arguments);return this};else if(CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure)return function(name,
value){if(name=="src"&&value.match(/^http:\/\//))try{standard.apply(this,arguments)}catch(e){}else standard.apply(this,arguments);return this};else return standard}(),setAttributes:function(attributesPairs){for(var name in attributesPairs)this.setAttribute(name,attributesPairs[name]);return this},setValue:function(value){this.$.value=value;return this},removeAttribute:function(){var standard=function(name){this.$.removeAttribute(name)};if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat))return function(name){if(name==
"class")name="className";else if(name=="tabindex")name="tabIndex";standard.call(this,name)};else return standard}(),removeAttributes:function(attributes){if(CKEDITOR.tools.isArray(attributes))for(var i=0;i<attributes.length;i++)this.removeAttribute(attributes[i]);else for(var attr in attributes)attributes.hasOwnProperty(attr)&&this.removeAttribute(attr)},removeStyle:function(name){this.setStyle(name,"");if(this.$.style.removeAttribute)this.$.style.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(name));
if(!this.$.style.cssText)this.removeAttribute("style")},setStyle:function(name,value){this.$.style[CKEDITOR.tools.cssStyleToDomStyle(name)]=value;return this},setStyles:function(stylesPairs){for(var name in stylesPairs)this.setStyle(name,stylesPairs[name]);return this},setOpacity:function(opacity){if(CKEDITOR.env.ie){opacity=Math.round(opacity*100);this.setStyle("filter",opacity>=100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+opacity+")")}else this.setStyle("opacity",opacity)},unselectable:CKEDITOR.env.gecko?
function(){this.$.style.MozUserSelect="none";this.on("dragstart",function(evt){evt.data.preventDefault()})}:CKEDITOR.env.webkit?function(){this.$.style.KhtmlUserSelect="none";this.on("dragstart",function(evt){evt.data.preventDefault()})}:function(){if(CKEDITOR.env.ie||CKEDITOR.env.opera){var element=this.$,e,i=0;element.unselectable="on";while(e=element.all[i++])switch(e.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:e.unselectable="on"}}},getPositionedAncestor:function(){var current=
this;while(current.getName()!="html"){if(current.getComputedStyle("position")!="static")return current;current=current.getParent()}return null},getDocumentPosition:function(refDocument){var x=0,y=0,doc=this.getDocument(),body=doc.getBody(),quirks=doc.$.compatMode=="BackCompat";if(document.documentElement["getBoundingClientRect"]){var box=this.$.getBoundingClientRect(),$doc=doc.$,$docElem=$doc.documentElement;var clientTop=$docElem.clientTop||body.$.clientTop||0,clientLeft=$docElem.clientLeft||body.$.clientLeft||
0,needAdjustScrollAndBorders=true;if(CKEDITOR.env.ie){var inDocElem=doc.getDocumentElement().contains(this),inBody=doc.getBody().contains(this);needAdjustScrollAndBorders=quirks&&inBody||!quirks&&inDocElem}if(needAdjustScrollAndBorders){x=box.left+(!quirks&&$docElem.scrollLeft||body.$.scrollLeft);x-=clientLeft;y=box.top+(!quirks&&$docElem.scrollTop||body.$.scrollTop);y-=clientTop}}else{var current=this,previous=null,offsetParent;while(current&&!(current.getName()=="body"||current.getName()=="html")){x+=
current.$.offsetLeft-current.$.scrollLeft;y+=current.$.offsetTop-current.$.scrollTop;if(!current.equals(this)){x+=current.$.clientLeft||0;y+=current.$.clientTop||0}var scrollElement=previous;while(scrollElement&&!scrollElement.equals(current)){x-=scrollElement.$.scrollLeft;y-=scrollElement.$.scrollTop;scrollElement=scrollElement.getParent()}previous=current;current=(offsetParent=current.$.offsetParent)?new CKEDITOR.dom.element(offsetParent):null}}if(refDocument){var currentWindow=this.getWindow(),
refWindow=refDocument.getWindow();if(!currentWindow.equals(refWindow)&&currentWindow.$.frameElement){var iframePosition=(new CKEDITOR.dom.element(currentWindow.$.frameElement)).getDocumentPosition(refDocument);x+=iframePosition.x;y+=iframePosition.y}}if(!document.documentElement["getBoundingClientRect"])if(CKEDITOR.env.gecko&&!quirks){x+=this.$.clientLeft?1:0;y+=this.$.clientTop?1:0}return{x:x,y:y}},scrollIntoView:function(alignTop){var win=this.getWindow(),winHeight=win.getViewPaneSize().height;
var offset=winHeight*-1;if(alignTop)offset+=winHeight;else{offset+=this.$.offsetHeight||0;offset+=parseInt(this.getComputedStyle("marginBottom")||0,10)||0}var elementPosition=this.getDocumentPosition();offset+=elementPosition.y;offset=offset<0?0:offset;var currentScroll=win.getScrollPosition().y;if(offset>currentScroll||offset<currentScroll-winHeight)win.$.scrollTo(0,offset)},setState:function(state){switch(state){case CKEDITOR.TRISTATE_ON:this.addClass("cke_on");this.removeClass("cke_off");this.removeClass("cke_disabled");
break;case CKEDITOR.TRISTATE_DISABLED:this.addClass("cke_disabled");this.removeClass("cke_off");this.removeClass("cke_on");break;default:this.addClass("cke_off");this.removeClass("cke_on");this.removeClass("cke_disabled");break}},getFrameDocument:function(){var $=this.$;try{$.contentWindow.document}catch(e){$.src=$.src;if(CKEDITOR.env.ie&&CKEDITOR.env.version<7)window.showModalDialog('javascript:document.write("'+"<script>"+"window.setTimeout("+"function(){window.close();}"+",50);"+'<\/script>")')}return $&&
new CKEDITOR.dom.document($.contentWindow.document)},copyAttributes:function(dest,skipAttributes){var attributes=this.$.attributes;skipAttributes=skipAttributes||{};for(var n=0;n<attributes.length;n++){var attribute=attributes[n];var attrName=attribute.nodeName.toLowerCase(),attrValue;if(attrName in skipAttributes)continue;if(attrName=="checked"&&(attrValue=this.getAttribute(attrName)))dest.setAttribute(attrName,attrValue);else if(attribute.specified||CKEDITOR.env.ie&&attribute.nodeValue&&attrName==
"value"){attrValue=this.getAttribute(attrName);if(attrValue===null)attrValue=attribute.nodeValue;dest.setAttribute(attrName,attrValue)}}if(this.$.style.cssText!=="")dest.$.style.cssText=this.$.style.cssText},renameNode:function(newTag){if(this.getName()==newTag)return;var doc=this.getDocument();var newNode=new CKEDITOR.dom.element(newTag,doc);this.copyAttributes(newNode);this.moveChildren(newNode);this.getParent()&&this.$.parentNode.replaceChild(newNode.$,this.$);newNode.$["data-cke-expando"]=this.$["data-cke-expando"];
this.$=newNode.$},getChild:function(indices){var rawNode=this.$;if(!indices.slice)rawNode=rawNode.childNodes[indices];else while(indices.length>0&&rawNode)rawNode=rawNode.childNodes[indices.shift()];return rawNode?new CKEDITOR.dom.node(rawNode):null},getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){this.on("contextmenu",function(event){if(!event.data.getTarget().hasClass("cke_enable_context_menu"))event.data.preventDefault()})},getDirection:function(useComputed){return useComputed?
this.getComputedStyle("direction")||this.getDirection()||this.getDocument().$.dir||this.getDocument().getBody().getDirection(1):this.getStyle("direction")||this.getAttribute("dir")},data:function(name,value){name="data-"+name;if(value===undefined)return this.getAttribute(name);else if(value===false)this.removeAttribute(name);else this.setAttribute(name,value);return null}});
(function(){var sides={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};function marginAndPaddingSize(type){var adjustment=0;for(var i=0,len=sides[type].length;i<len;i++)adjustment+=parseInt(this.getComputedStyle(sides[type][i])||0,10)||0;return adjustment}CKEDITOR.dom.element.prototype.setSize=function(type,size,isBorderBox){if(typeof size=="number"){if(isBorderBox&&!(CKEDITOR.env.ie&&
CKEDITOR.env.quirks))size-=marginAndPaddingSize.call(this,type);this.setStyle(type,size+"px")}};CKEDITOR.dom.element.prototype.getSize=function(type,isBorderBox){var size=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(type)],this.$["client"+CKEDITOR.tools.capitalize(type)])||0;if(isBorderBox)size-=marginAndPaddingSize.call(this,type);return size}})();